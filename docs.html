<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Vault1337 documentation — installation, configuration, analysis tools, and usage guide.">
  <title>Vault1337 — Documentation</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="custom.css">
  <link rel="shortcut icon" type="image/png" href="Images/favicon.png">
</head>
<body>

<!-- ── Navbar ─────────────────────────────────────────────────────────────── -->
<nav class="navbar navbar-expand-lg fixed-top">
  <div class="container">
    <a class="navbar-brand" href="index.html">
      <img src="Images/white-logo-no-background.svg" alt="Vault1337">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="nav">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link active" href="docs.html">Documentation</a></li>
        <li class="nav-item">
          <a class="nav-link nav-gh" href="https://github.com/DanDreadless/Vault1337" target="_blank">
            <i class="bi bi-github me-1"></i>GitHub
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- ── Docs body ──────────────────────────────────────────────────────────── -->
<div class="container section">
  <div class="docs-wrap">

    <!-- Sidebar -->
    <aside class="docs-sidebar">
      <ul class="d-nav">
        <li class="d-group">Installation</li>
        <li><a href="#install-docker">Docker (Quick Start)</a></li>
        <li><a href="#compose">Docker Compose</a></li>
        <li><a href="#local">Local Development</a></li>

        <li class="d-group">Configuration</li>
        <li><a href="#env-vars">Environment Variables</a></li>
        <li><a href="#api-keys">API Keys</a></li>

        <li class="d-group">Using Vault1337</li>
        <li><a href="#uploading">Uploading Samples</a></li>
        <li><a href="#tools">Analysis Tools</a></li>
        <li><a href="#yara">YARA Rules</a></li>
        <li><a href="#ioc">IOC Management</a></li>
        <li><a href="#ip">IP Intelligence</a></li>
        <li><a href="#tags">Tags &amp; Search</a></li>
        <li><a href="#report">Sample Report</a></li>

        <li class="d-group">Reference</li>
        <li><a href="#stack">Tech Stack</a></li>
        <li><a href="#api-ref">REST API</a></li>
        <li><a href="#ack">Acknowledgements</a></li>
      </ul>
    </aside>

    <!-- Main content -->
    <main class="docs-content">

      <!-- ── Docker Quick Start ── -->
      <h2 id="install-docker"><i class="bi bi-box-seam me-2" style="color:var(--accent);"></i>Docker (Quick Start)</h2>
      <p>The fastest way to run Vault1337. Uses SQLite — data is not persisted after the container stops.</p>

      <div class="callout"><strong>Requirements:</strong> Docker installed on your system. See the <a href="https://docs.docker.com/engine/install/" target="_blank">official Docker docs</a>.</div>

      <div class="step">
        <div class="step-n">1</div>
        <div class="step-b">
          <h5>Pull the image</h5>
          <pre>docker pull vault1337/vault1337:latest</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">2</div>
        <div class="step-b">
          <h5>Run the container</h5>
          <pre>docker run -p 8000:8000 \
  -e SECRET_KEY=change-me-to-a-long-random-string \
  -e DEBUG=True \
  vault1337/vault1337:latest</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">3</div>
        <div class="step-b">
          <h5>Log in</h5>
          <p>Open <strong>http://localhost:8000</strong> and log in with the default credentials:</p>
          <pre>Username: admin
Password: changeme123</pre>
          <div class="callout"><strong>Important:</strong> Change your password immediately at <code>http://localhost:8000/admin/</code></div>
        </div>
      </div>

      <div class="step">
        <div class="step-n">4</div>
        <div class="step-b">
          <h5>Add API keys (optional)</h5>
          <p>Navigate to <strong>Admin → API Keys</strong> to add keys for the intelligence integrations. See the <a href="#api-keys">API Keys</a> section below.</p>
        </div>
      </div>

      <!-- ── Docker Compose ── -->
      <h2 id="compose"><i class="bi bi-diagram-3 me-2" style="color:var(--accent);"></i>Docker Compose</h2>
      <p>Recommended for persistent deployments. Spins up Vault1337 with a PostgreSQL database and named volumes for samples and YARA rules.</p>

      <div class="step">
        <div class="step-n">1</div>
        <div class="step-b">
          <h5>Clone the repository</h5>
          <pre>git clone https://github.com/DanDreadless/Vault1337.git
cd Vault1337/Docker</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">2</div>
        <div class="step-b">
          <h5>Configure the environment</h5>
          <p>All settings live in <code>Docker/.env</code>. Open it and set at minimum:</p>
          <div class="v-wrap mb-2">
            <table class="v-table">
              <thead><tr><th>Variable</th><th>Description</th></tr></thead>
              <tbody>
                <tr><td><code>SECRET_KEY</code></td><td>Long random string — generate with <code>openssl rand -hex 50</code></td></tr>
                <tr><td><code>POSTGRES_PASSWORD</code></td><td>Password for the PostgreSQL database</td></tr>
                <tr><td><code>DJANGO_SUPERUSER_PASSWORD</code></td><td>Initial admin account password</td></tr>
                <tr><td><code>ALLOWED_HOSTS</code></td><td>Comma-separated hostnames or IPs, e.g. <code>localhost,192.168.1.10</code></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="step">
        <div class="step-n">3</div>
        <div class="step-b">
          <h5>Start the stack</h5>
          <pre>docker compose up -d</pre>
          <p>This builds the image (if not already built), starts PostgreSQL, waits for a health check, then starts Gunicorn. Migrations and superuser creation happen automatically on first run.</p>
        </div>
      </div>

      <div class="step">
        <div class="step-n">4</div>
        <div class="step-b">
          <h5>Open Vault1337</h5>
          <p>Navigate to <strong>http://localhost:8000</strong> (or your configured <code>HOST_PORT</code>) and log in.</p>
          <pre># View logs
docker compose logs -f

# Stop the stack (data preserved)
docker compose down

# Stop and wipe all data
docker compose down -v</pre>
        </div>
      </div>

      <!-- ── Local Dev ── -->
      <h2 id="local"><i class="bi bi-terminal me-2" style="color:var(--accent);"></i>Local Development</h2>
      <p>Requires Python 3.12+, Node.js 22+, and (optionally) PostgreSQL.</p>

      <div class="step">
        <div class="step-n">1</div>
        <div class="step-b">
          <h5>Clone and set up a Python virtual environment</h5>
          <pre>git clone https://github.com/DanDreadless/Vault1337.git
cd Vault1337
python3 -m venv env
source env/bin/activate   # Windows: env\Scripts\activate
pip install -r requirements.txt</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">2</div>
        <div class="step-b">
          <h5>Install system dependencies</h5>
          <pre># Ubuntu / Debian
sudo apt install -y libimage-exiftool-perl libmpc-dev libgl1 libglib2.0-0</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">3</div>
        <div class="step-b">
          <h5>Configure the environment</h5>
          <p>Copy the Docker env template and edit it for local use:</p>
          <pre>cp Docker/.env .env
# Edit .env — set SECRET_KEY and DEBUG=True
# Leave DATABASE_URL empty to use SQLite</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">4</div>
        <div class="step-b">
          <h5>Run migrations and create a superuser</h5>
          <pre>python manage.py migrate
python manage.py createsuperuser</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">5</div>
        <div class="step-b">
          <h5>Start the Django API</h5>
          <pre>python manage.py runserver</pre>
        </div>
      </div>

      <div class="step">
        <div class="step-n">6</div>
        <div class="step-b">
          <h5>Start the React frontend (second terminal)</h5>
          <pre>cd frontend
npm install
npm run dev</pre>
          <p>Open <strong>http://localhost:5173</strong>. The Vite dev server proxies <code>/api/</code> requests to Django on port 8000.</p>
        </div>
      </div>

      <!-- ── Env Vars ── -->
      <h2 id="env-vars"><i class="bi bi-gear me-2" style="color:var(--accent);"></i>Environment Variables</h2>
      <p>All configuration is handled via environment variables loaded from a <code>.env</code> file (or passed directly to the container).</p>
      <div class="v-wrap">
        <table class="v-table">
          <thead><tr><th>Variable</th><th>Default</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>SECRET_KEY</code></td><td><em>required</em></td><td>Django secret key — use a long random string</td></tr>
            <tr><td><code>DEBUG</code></td><td><code>False</code></td><td>Set <code>True</code> for local development only</td></tr>
            <tr><td><code>ALLOWED_HOSTS</code></td><td><code>127.0.0.1</code></td><td>Comma-separated list of allowed hostnames/IPs</td></tr>
            <tr><td><code>DATABASE_URL</code></td><td><em>SQLite</em></td><td>PostgreSQL connection string, e.g. <code>postgres://user:pass@host:5432/db</code></td></tr>
            <tr><td><code>CORS_ALLOWED_ORIGINS</code></td><td><code>http://localhost:5173</code></td><td>Comma-separated origins allowed for CORS requests</td></tr>
            <tr><td><code>MAX_UPLOAD_SIZE_MB</code></td><td><code>200</code></td><td>Maximum file upload size in megabytes</td></tr>
            <tr><td><code>POSTGRES_DB</code></td><td><code>vault1337</code></td><td>PostgreSQL database name (Compose only)</td></tr>
            <tr><td><code>POSTGRES_USER</code></td><td><code>vault</code></td><td>PostgreSQL username (Compose only)</td></tr>
            <tr><td><code>POSTGRES_PASSWORD</code></td><td><em>required</em></td><td>PostgreSQL password (Compose only)</td></tr>
            <tr><td><code>DJANGO_SUPERUSER_USERNAME</code></td><td><code>admin</code></td><td>Superuser created on first container startup</td></tr>
            <tr><td><code>DJANGO_SUPERUSER_EMAIL</code></td><td><code>admin@localhost</code></td><td>Superuser email</td></tr>
            <tr><td><code>DJANGO_SUPERUSER_PASSWORD</code></td><td><code>changeme123</code></td><td>Superuser initial password — change this</td></tr>
            <tr><td><code>HOST_PORT</code></td><td><code>8000</code></td><td>Host port mapped to container port 8000</td></tr>
          </tbody>
        </table>
      </div>

      <!-- ── API Keys ── -->
      <h2 id="api-keys"><i class="bi bi-key me-2" style="color:var(--accent);"></i>API Keys</h2>
      <p>Third-party intelligence features require API keys. Add them via the web UI at <strong>Admin → API Keys</strong> (staff account required), or set them in your <code>.env</code> file before starting the container.</p>
      <div class="v-wrap">
        <table class="v-table">
          <thead><tr><th>Key</th><th>Service</th><th>Used for</th></tr></thead>
          <tbody>
            <tr><td><code>VT_KEY</code></td><td><a href="https://www.virustotal.com/" target="_blank">VirusTotal</a></td><td>Download samples by SHA256 hash</td></tr>
            <tr><td><code>MALWARE_BAZAAR_KEY</code></td><td><a href="https://bazaar.abuse.ch/api/" target="_blank">MalwareBazaar</a></td><td>Download samples by SHA256 hash</td></tr>
            <tr><td><code>ABUSEIPDB_KEY</code></td><td><a href="https://www.abuseipdb.com/api.html" target="_blank">AbuseIPDB</a></td><td>IP reputation lookups</td></tr>
            <tr><td><code>SPUR_KEY</code></td><td><a href="https://spur.us/context-api/" target="_blank">Spur</a></td><td>VPN / proxy / residential IP context</td></tr>
            <tr><td><code>SHODAN_KEY</code></td><td><a href="https://account.shodan.io/" target="_blank">Shodan</a></td><td>Open ports and banner data for an IP</td></tr>
          </tbody>
        </table>
      </div>

      <!-- ── Uploading ── -->
      <h2 id="uploading"><i class="bi bi-cloud-upload me-2" style="color:var(--accent);"></i>Uploading Samples</h2>
      <p>Navigate to <strong>Upload</strong> in the navigation bar. Four ingestion methods are available:</p>
      <div class="v-wrap mb-3">
        <table class="v-table">
          <thead><tr><th>Method</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><strong>Upload File</strong></td><td>Direct file upload (max 200 MB). Optionally extract a ZIP or 7z archive with a password.</td></tr>
            <tr><td><strong>Fetch URL</strong></td><td>Download a sample from an external URL. Private/internal IP ranges are blocked (SSRF protection).</td></tr>
            <tr><td><strong>VirusTotal</strong></td><td>Download a sample by SHA256 hash using your VT API key.</td></tr>
            <tr><td><strong>MalwareBazaar</strong></td><td>Download a sample by SHA256 hash using your MB API key.</td></tr>
          </tbody>
        </table>
      </div>
      <p>All samples are stored by SHA256 hash. Original filenames are preserved in the database but never used as file paths on disk. Add comma-separated tags during upload for easier organisation.</p>

      <!-- ── Tools ── -->
      <h2 id="tools"><i class="bi bi-tools me-2" style="color:var(--accent);"></i>Analysis Tools</h2>
      <p>Open a sample from the vault and select the <strong>Tools</strong> tab. The tool selector automatically filters and groups available tools based on the detected file type (PE, ELF, Mach-O, document, archive, email, script). A <strong>Show all tools</strong> checkbox is available for edge cases such as polyglot files.</p>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">Universal — all file types</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>Strings</strong></td>
              <td><code>UTF-8</code> <code>ASCII</code> <code>Wide (UTF-16LE)</code> <code>Latin-1</code> <code>UTF-16</code> <code>UTF-32</code></td>
              <td>Extracts printable strings across multiple encodings, including wide strings commonly used to hide Windows API calls.</td>
            </tr>
            <tr>
              <td><strong>Extract IOCs</strong></td>
              <td>—</td>
              <td>Scans the sample for indicators of compromise and saves them to the IOC database linked to this sample. Detects: IP addresses, domains, URLs, emails, Bitcoin addresses, CVE IDs, registry keys, named pipes/mutexes, Windows persistence paths (Run/RunOnce/Services), scheduled task paths, Linux cron paths, systemd unit paths, and macOS LaunchAgent/LaunchDaemon plists.</td>
            </tr>
            <tr>
              <td><strong>Hex Viewer</strong></td>
              <td>—</td>
              <td>Renders a hex dump of the sample with ASCII sidebar.</td>
            </tr>
            <tr>
              <td><strong>Run YARA Rules</strong></td>
              <td>—</td>
              <td>Runs all saved YARA rules against the sample and reports matches with rule name, matched strings, and file offsets.</td>
            </tr>
            <tr>
              <td><strong>ExifTool</strong></td>
              <td>—</td>
              <td>Reads all metadata tags from a file using <a href="https://exiftool.org/" target="_blank">ExifTool</a> by Phil Harvey.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">Windows (PE)</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>LIEF Parser</strong></td>
              <td><code>DOS Header</code> <code>Rich Header</code> <code>PE Header</code> <code>Entrypoint</code> <code>Sections</code> <code>Imports</code> <code>Signature Check</code> <code>Check Entropy</code> <code>Import Hash (LIEF)</code> <code>Overlay Detection</code> <code>Rich Header Hash</code> <code>Exports</code></td>
              <td>Comprehensive PE binary analysis via the <a href="https://github.com/lief-project/LIEF" target="_blank">LIEF project</a>. Covers all standard PE structures including the export directory and digital signature verification.</td>
            </tr>
            <tr>
              <td><strong>PE File</strong></td>
              <td><code>Import Hash</code> <code>Rich Header Hash</code> <code>Resources</code> <code>Version Info</code> <code>Overlay</code> <code>Suspicious Imports</code> <code>Section Entropy</code> <code>Packer Detection</code> <code>Compile Timestamp</code> <code>Anti-VM Detection</code></td>
              <td>PE-focused analysis via <a href="https://github.com/erocarrera/pefile" target="_blank">pefile</a>. Highlights suspicious Windows API imports (62 APIs across 8 categories), detects known packers by section name and entropy heuristics, checks compile timestamp for anomalies (future dates, pre-1993, zeroed, known fakes), and scans raw bytes for 50+ anti-VM/sandbox artifact strings (VMware, VirtualBox, QEMU, Hyper-V, analysis tools).</td>
            </tr>
            <tr>
              <td><strong>Disassembler</strong></td>
              <td>—</td>
              <td>Disassembles code at the entry point using <a href="https://www.capstone-engine.org/" target="_blank">Capstone</a>. Supports x86, x86-64, and ARM architectures with automatic detection.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">Linux (ELF)</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>LIEF Parser</strong></td>
              <td><code>ELF Header</code> <code>ELF Sections</code> <code>ELF Symbols</code> <code>ELF Suspicious Symbols</code> <code>ELF Packer Detection</code> <code>ELF Segments</code> <code>ELF Binary Info</code></td>
              <td>ELF binary analysis via LIEF. <em>ELF Suspicious Symbols</em> flags 67 dangerous dynamic symbols across Execution, Network, Privilege Escalation, Anti-Analysis/Injection, Dynamic Loading, Rootkit/File Hiding, and Surveillance categories. <em>ELF Segments</em> lists all program headers and flags W+X PT_LOAD segments. <em>ELF Binary Info</em> reports stripped status, linking type, and interpreter path.</td>
            </tr>
            <tr>
              <td><strong>Disassembler</strong></td>
              <td>—</td>
              <td>Entry point disassembly via Capstone with architecture auto-detection.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">macOS (Mach-O)</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>Mach-O Tool</strong></td>
              <td><code>Header</code> <code>Load Commands</code> <code>Imported Libraries</code> <code>Exported Functions</code> <code>Symbols</code> <code>Sections &amp; Entropy</code> <code>Code Signature</code> <code>Entitlements</code> <code>Encrypted Segments</code></td>
              <td>Mach-O binary analysis via LIEF. Supports fat binaries (reports all architectures). <em>Imported Libraries</em> annotates dylibs by capability category (Keychain, Network, Camera, Location, etc.). <em>Entitlements</em> extracts the embedded XML plist from the code signature blob. <em>Encrypted Segments</em> detects <code>LC_ENCRYPTION_INFO</code> / <code>LC_ENCRYPTION_INFO_64</code> load commands (App Store DRM / FairPlay) and high-entropy sections.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">Documents &amp; PDFs</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>PDF Parser</strong></td>
              <td><code>Extract Metadata</code> <code>Extract Content</code> <code>Extract Images</code> <code>Extract URLs</code> <code>JavaScript</code> <code>Embedded Files</code></td>
              <td>PDF forensics via <a href="https://pymupdf.readthedocs.io/" target="_blank">PyMuPDF</a>. Surfaces embedded JavaScript, embedded files, URLs, and document metadata.</td>
            </tr>
            <tr>
              <td><strong>OLETools</strong></td>
              <td><code>OLEID</code> <code>OLEMETA</code> <code>OLEDUMP</code> <code>OLEVBA</code> <code>RTFOBJ</code> <code>OLEOBJ</code></td>
              <td>Analyses Microsoft OLE2 compound files (Office documents, RTF) via <a href="https://github.com/decalage2/oletools" target="_blank">Oletools</a>. Detects VBA macros, auto-execution triggers, embedded objects, and obfuscation.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="mt-4 mb-2" style="font-size:1rem; color:var(--accent);">Archives &amp; Email</h3>
      <div class="v-wrap mb-4">
        <table class="v-table">
          <thead><tr><th>Tool</th><th>Sub-options</th><th>Description</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>Zip Extractor</strong></td>
              <td><code>With password</code> <code>Without password</code></td>
              <td>Extracts <code>.zip</code> and <code>.7z</code> archives. All extracted files are added to the vault as individual samples and automatically enriched with VirusTotal data.</td>
            </tr>
            <tr>
              <td><strong>Email Parser</strong></td>
              <td><code>Email Headers</code> <code>Email Body</code> <code>Download Attachments</code> <code>URL Extractor</code></td>
              <td>Parses <code>.eml</code> and <code>.msg</code> files. Attachments are downloaded directly into the vault for further analysis.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ── YARA ── -->
      <h2 id="yara"><i class="bi bi-code-square me-2" style="color:var(--accent);"></i>YARA Rules</h2>
      <p>Navigate to <strong>YARA</strong> in the navigation bar to manage rules.</p>
      <ul>
        <li>Create new rules using the built-in editor — paste or write YARA syntax directly.</li>
        <li>Edit existing rules at any time.</li>
        <li>Run all rules against a specific sample from the sample detail page using the <strong>Run YARA Rules</strong> tool.</li>
        <li>Results show the matching rule name, tags, matched string identifiers, file offsets, and match lengths.</li>
        <li>Rules are stored as <code>.yar</code> files in <code>vault/yara-rules/</code> on the server.</li>
      </ul>
      <div class="callout">Rules with syntax errors will fail to save — the editor will report the parse error inline.</div>

      <div class="callout"><strong>No rules are included by default</strong> — Vault1337 ships with an empty rules directory. You need to add your own <code>.yar</code> files via the web editor or by placing them in the <code>vault/yara-rules/</code> directory on the server.</div>

      <!-- ── IOC ── -->
      <h2 id="ioc"><i class="bi bi-crosshair me-2" style="color:var(--accent);"></i>IOC Management</h2>
      <p>Navigate to <strong>IOCs</strong> to view all extracted indicators of compromise across all samples.</p>
      <ul>
        <li>Run the <strong>Extract IOCs</strong> tool on a sample to populate its IOCs.</li>
        <li>Each IOC is linked back to the sample it came from.</li>
        <li>Mark IOCs as true positive or false positive using the toggle on the IOC page.</li>
        <li>Filter the list by classification (true / false / unreviewed) and search by value.</li>
      </ul>
      <p><strong>IOC types extracted:</strong></p>
      <div class="v-wrap">
        <table class="v-table">
          <thead><tr><th>Type</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>ip</code></td><td>IPv4 addresses</td></tr>
            <tr><td><code>domain</code></td><td>Domains validated against the public suffix list</td></tr>
            <tr><td><code>url</code></td><td>HTTP / HTTPS / FTP URLs</td></tr>
            <tr><td><code>email</code></td><td>Email addresses</td></tr>
            <tr><td><code>bitcoin</code></td><td>Bitcoin wallet addresses</td></tr>
            <tr><td><code>cve</code></td><td>CVE identifiers (e.g. CVE-2021-44228)</td></tr>
            <tr><td><code>registry</code></td><td>Windows registry key paths (HKLM / HKCU etc.)</td></tr>
            <tr><td><code>named_pipe</code></td><td>Named pipe and mutex paths</td></tr>
            <tr><td><code>win_persistence</code></td><td>Windows Run / RunOnce / Services registry persistence paths</td></tr>
            <tr><td><code>scheduled_task</code></td><td>Scheduled task file paths and schtasks command references</td></tr>
            <tr><td><code>linux_cron</code></td><td>Linux cron paths (<code>/etc/cron*</code>, <code>/var/spool/cron</code>)</td></tr>
            <tr><td><code>systemd_unit</code></td><td>Systemd service / timer / socket unit file paths</td></tr>
            <tr><td><code>macos_launchagent</code></td><td>macOS LaunchAgent and LaunchDaemon plist paths</td></tr>
          </tbody>
        </table>
      </div>

      <!-- ── IP ── -->
      <h2 id="ip"><i class="bi bi-globe2 me-2" style="color:var(--accent);"></i>IP Intelligence</h2>
      <p>Navigate to <strong>IP Check</strong> to query an IP address against multiple threat intelligence sources simultaneously.</p>
      <ul>
        <li>Aggregates results from <strong>AbuseIPDB</strong>, <strong>Spur</strong>, and <strong>Shodan</strong> in a single request.</li>
        <li>Private, loopback, and reserved IP ranges are rejected before any external query is made.</li>
        <li>Requires at least one API key to be configured for results to be returned.</li>
      </ul>

      <!-- ── Tags ── -->
      <h2 id="tags"><i class="bi bi-tags me-2" style="color:var(--accent);"></i>Tags &amp; Search</h2>
      <ul>
        <li>Add comma-separated tags when uploading a sample.</li>
        <li>Add or remove tags from any sample on the sample detail page.</li>
        <li>All tags are stored in lowercase automatically.</li>
        <li>Use the search bar on the <strong>Vault</strong> page to filter samples by filename, hash, or tag.</li>
        <li>Results are paginated — use the page controls at the bottom of the vault list.</li>
      </ul>

      <!-- ── Sample Report ── -->
      <h2 id="report"><i class="bi bi-file-earmark-bar-graph me-2" style="color:var(--accent);"></i>Sample Report</h2>
      <p>Every sample has a structured JSON report available at <code>GET /api/v1/files/{id}/report/</code>. The report aggregates all stored analysis data in a single response — no new analysis is run.</p>
      <p>The report includes:</p>
      <ul>
        <li><strong>File metadata</strong> — name, size, magic bytes, MIME type, upload date, uploader</li>
        <li><strong>Hashes</strong> — MD5, SHA1, SHA256, SHA512</li>
        <li><strong>Tags</strong> — all tags applied to the sample</li>
        <li><strong>VirusTotal summary</strong> — detection counts (malicious / suspicious / undetected / harmless), threat label, threat category, scan date, and known names</li>
        <li><strong>IOCs</strong> — all confirmed (true positive) IOCs grouped by type</li>
      </ul>
      <div class="callout">VirusTotal data is only included if a VT enrichment has previously been run on the sample (automatically on upload if a VT API key is configured, or manually via the VT Enrich action).</div>

      <!-- ── Tech Stack ── -->
      <h2 id="stack"><i class="bi bi-layers me-2" style="color:var(--accent);"></i>Tech Stack</h2>
      <div class="v-wrap">
        <table class="v-table">
          <thead><tr><th>Layer</th><th>Technology</th></tr></thead>
          <tbody>
            <tr><td>Backend</td><td>Python 3.12 / Django 5.2 / Django REST Framework</td></tr>
            <tr><td>Authentication</td><td>JWT — djangorestframework-simplejwt with token blacklisting</td></tr>
            <tr><td>API docs</td><td>drf-spectacular — Swagger UI at <code>/api/v1/docs/</code></td></tr>
            <tr><td>Frontend</td><td>React 19 / TypeScript / Vite 6 / Tailwind CSS 4</td></tr>
            <tr><td>Database</td><td>PostgreSQL (production) / SQLite (development)</td></tr>
            <tr><td>Static files</td><td>WhiteNoise (serves React SPA + Django admin assets)</td></tr>
            <tr><td>Production server</td><td>Gunicorn (4 workers) + NGINX</td></tr>
            <tr><td>Container</td><td>Docker — <code>vault1337/vault1337:latest</code></td></tr>
          </tbody>
        </table>
      </div>

      <!-- ── API ── -->
      <h2 id="api-ref"><i class="bi bi-braces me-2" style="color:var(--accent);"></i>REST API</h2>
      <p>All endpoints are under <code>/api/v1/</code>. JWT Bearer token authentication is required on all endpoints except registration and token endpoints.</p>
      <div class="v-wrap mb-3">
        <table class="v-table">
          <thead><tr><th>Endpoint</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>POST /api/v1/auth/register/</code></td><td>Register a new user account</td></tr>
            <tr><td><code>POST /api/v1/auth/token/</code></td><td>Obtain JWT access + refresh token</td></tr>
            <tr><td><code>POST /api/v1/auth/token/refresh/</code></td><td>Refresh an access token</td></tr>
            <tr><td><code>POST /api/v1/auth/logout/</code></td><td>Blacklist a refresh token</td></tr>
            <tr><td><code>GET/PATCH /api/v1/auth/user/</code></td><td>Current user profile</td></tr>
            <tr><td><code>GET/POST /api/v1/files/</code></td><td>List vault / upload a sample</td></tr>
            <tr><td><code>GET/DELETE /api/v1/files/{id}/</code></td><td>Sample detail / delete</td></tr>
            <tr><td><code>GET /api/v1/files/{id}/download/</code></td><td>Download sample file</td></tr>
            <tr><td><code>POST /api/v1/files/{id}/run_tool/</code></td><td>Run an analysis tool</td></tr>
            <tr><td><code>POST /api/v1/files/{id}/add_tag/</code></td><td>Add a tag to a sample</td></tr>
            <tr><td><code>POST /api/v1/files/{id}/remove_tag/</code></td><td>Remove a tag from a sample</td></tr>
            <tr><td><code>GET/POST /api/v1/files/{id}/comments/</code></td><td>List / add comments on a sample</td></tr>
            <tr><td><code>GET /api/v1/files/{id}/report/</code></td><td>Structured JSON report (hashes, VT, IOCs, tags)</td></tr>
            <tr><td><code>POST /api/v1/files/{id}/vt-enrich/</code></td><td>Fetch / refresh VirusTotal data for a sample</td></tr>
            <tr><td><code>POST /api/v1/files/fetch_url/</code></td><td>Fetch a sample from a URL</td></tr>
            <tr><td><code>POST /api/v1/files/vt-download/</code></td><td>Download from VirusTotal by SHA256</td></tr>
            <tr><td><code>POST /api/v1/files/mb-download/</code></td><td>Download from MalwareBazaar by SHA256</td></tr>
            <tr><td><code>GET/PATCH /api/v1/iocs/</code></td><td>List and update IOCs</td></tr>
            <tr><td><code>GET/POST/PUT/DELETE /api/v1/yara/</code></td><td>YARA rule management</td></tr>
            <tr><td><code>POST /api/v1/intel/ip/</code></td><td>IP intelligence lookup</td></tr>
            <tr><td><code>GET/POST /api/v1/admin/keys/</code></td><td>API key management (staff only)</td></tr>
            <tr><td><code>POST /api/v1/tools/qr-decode/</code></td><td>Stateless QR code decode</td></tr>
          </tbody>
        </table>
      </div>
      <p>Interactive API documentation (Swagger UI) is available at <code>/api/v1/docs/</code> on any running instance.</p>

      <!-- ── Acknowledgements ── -->
      <h2 id="ack"><i class="bi bi-heart me-2" style="color:var(--accent);"></i>Acknowledgements</h2>
      <p>Vault1337 is built on outstanding open-source projects and public APIs.</p>

      <p style="color:var(--accent); font-size:.75rem; font-weight:600; letter-spacing:.08em; text-transform:uppercase; margin-bottom:.5rem; margin-top:1.5rem;">Analysis Libraries</p>
      <div class="ack-wrap mb-3">
        <a class="ack-pill" href="https://github.com/lief-project/LIEF" target="_blank">LIEF</a>
        <a class="ack-pill" href="https://github.com/erocarrera/pefile" target="_blank">pefile</a>
        <a class="ack-pill" href="https://www.capstone-engine.org/" target="_blank">Capstone</a>
        <a class="ack-pill" href="https://github.com/VirusTotal/yara-python" target="_blank">YARA-Python</a>
        <a class="ack-pill" href="https://github.com/decalage2/oletools" target="_blank">Oletools</a>
        <a class="ack-pill" href="https://pymupdf.readthedocs.io/" target="_blank">PyMuPDF</a>
        <a class="ack-pill" href="https://exiftool.org/" target="_blank">ExifTool</a>
        <a class="ack-pill" href="https://github.com/nicowillis/pyzipper" target="_blank">pyzipper</a>
        <a class="ack-pill" href="https://github.com/miurahr/py7zr" target="_blank">py7zr</a>
        <a class="ack-pill" href="https://github.com/john-kurkowski/tldextract" target="_blank">tldextract</a>
        <a class="ack-pill" href="https://github.com/astanin/python-tabulate" target="_blank">tabulate</a>
      </div>

      <p style="color:var(--accent); font-size:.75rem; font-weight:600; letter-spacing:.08em; text-transform:uppercase; margin-bottom:.5rem;">Backend &amp; Framework</p>
      <div class="ack-wrap mb-3">
        <a class="ack-pill" href="https://www.python.org/" target="_blank">Python</a>
        <a class="ack-pill" href="https://www.djangoproject.com/" target="_blank">Django</a>
        <a class="ack-pill" href="https://www.django-rest-framework.org/" target="_blank">Django REST Framework</a>
        <a class="ack-pill" href="https://python-requests.org/" target="_blank">Requests</a>
      </div>

      <p style="color:var(--accent); font-size:.75rem; font-weight:600; letter-spacing:.08em; text-transform:uppercase; margin-bottom:.5rem;">Intelligence APIs</p>
      <div class="ack-wrap mb-3">
        <a class="ack-pill" href="https://www.virustotal.com/" target="_blank">VirusTotal</a>
        <a class="ack-pill" href="https://bazaar.abuse.ch/api/" target="_blank">MalwareBazaar</a>
        <a class="ack-pill" href="https://www.abuseipdb.com/api.html" target="_blank">AbuseIPDB</a>
        <a class="ack-pill" href="https://spur.us/context-api/" target="_blank">Spur</a>
        <a class="ack-pill" href="https://account.shodan.io/" target="_blank">Shodan</a>
      </div>

      <p style="color:var(--accent); font-size:.75rem; font-weight:600; letter-spacing:.08em; text-transform:uppercase; margin-bottom:.5rem;">Frontend</p>
      <div class="ack-wrap mb-3">
        <a class="ack-pill" href="https://react.dev/" target="_blank">React</a>
        <a class="ack-pill" href="https://vitejs.dev/" target="_blank">Vite</a>
        <a class="ack-pill" href="https://www.typescriptlang.org/" target="_blank">TypeScript</a>
        <a class="ack-pill" href="https://tailwindcss.com/" target="_blank">Tailwind CSS</a>
        <a class="ack-pill" href="https://axios-http.com/" target="_blank">Axios</a>
        <a class="ack-pill" href="https://reactrouter.com/" target="_blank">React Router</a>
      </div>

      <p style="color:var(--accent); font-size:.75rem; font-weight:600; letter-spacing:.08em; text-transform:uppercase; margin-bottom:.5rem;">Infrastructure</p>
      <div class="ack-wrap">
        <a class="ack-pill" href="https://gunicorn.org/" target="_blank">Gunicorn</a>
        <a class="ack-pill" href="https://whitenoise.readthedocs.io/" target="_blank">WhiteNoise</a>
        <a class="ack-pill" href="https://www.postgresql.org/" target="_blank">PostgreSQL</a>
        <a class="ack-pill" href="https://www.docker.com/" target="_blank">Docker</a>
        <a class="ack-pill" href="https://nginx.org/" target="_blank">NGINX</a>
      </div>

    </main>
  </div><!-- /docs-wrap -->
</div><!-- /container -->

<!-- ── Footer ────────────────────────────────────────────────────────────── -->
<footer>
  <div class="container">
    <div class="f-links">
      <a href="index.html">Home</a>
      <a href="docs.html">Documentation</a>
      <a href="https://github.com/DanDreadless/Vault1337" target="_blank">GitHub</a>
      <a href="https://github.com/DanDreadless/Vault1337/blob/main/LICENSE" target="_blank">AGPL-3.0</a>
      <a href="https://x.com/DanDreadless" target="_blank">@DanDreadless</a>
    </div>
    <p>Vault1337 &mdash; Malware Analysis Platform &mdash; &copy; <span id="yr"></span></p>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.getElementById('yr').textContent = new Date().getFullYear();

  // Highlight active sidebar link on scroll
  const headings = document.querySelectorAll('.docs-content h2, .docs-content h3');
  const links = document.querySelectorAll('.d-nav a');
  const obs = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        links.forEach(l => l.classList.remove('active'));
        const match = document.querySelector(`.d-nav a[href="#${e.target.id}"]`);
        if (match) match.classList.add('active');
      }
    });
  }, { rootMargin: '-60px 0px -70% 0px' });
  headings.forEach(h => { if (h.id) obs.observe(h); });
</script>
</body>
</html>
